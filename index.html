<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบลงทะเบียนรถยนต์ - TCM Transportation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .map-container {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            position: relative;
            overflow: hidden;
        }
        .vehicle-marker {
            position: absolute;
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }
        .road {
            position: absolute;
            background: #666;
            border-radius: 2px;
        }
        .road-horizontal {
            height: 4px;
            width: 100%;
            top: 50%;
        }
        .road-vertical {
            width: 4px;
            height: 100%;
            left: 30%;
        }
        .road-vertical-2 {
            width: 4px;
            height: 100%;
            left: 70%;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-blue-900 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-white p-2 rounded-lg">
                        <svg class="w-8 h-8 text-blue-900" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">TCM Transportation</h1>
                        <p class="text-blue-200">ระบบจัดการรถยนต์แผนกขนส่ง</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm text-blue-200">วันที่: <span id="currentDate"></span></p>
                    <p class="text-sm text-blue-200">เวลา: <span id="currentTime"></span></p>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Registration Form Panel -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                        </svg>
                        ลงทะเบียนการใช้รถ
                    </h2>
                    
                    <form id="vehicleForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">หมายเลขทะเบียนรถ</label>
                            <input type="text" id="plateNumber" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="เช่น กข-1234" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ชื่อผู้ขับ</label>
                            <input type="text" id="driverName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ชื่อ-นามสกุล" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">งานที่ไป</label>
                            <select id="jobType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                <option value="">เลือกประเภทงาน</option>
                                <option value="ส่งสินค้า">ส่งสินค้า</option>
                                <option value="รับสินค้า">รับสินค้า</option>
                                <option value="ติดต่อลูกค้า">ติดต่อลูกค้า</option>
                                <option value="ประชุมนอกสถานที่">ประชุมนอกสถานที่</option>
                                <option value="บำรุงรักษา">บำรุงรักษา</option>
                                <option value="อื่นๆ">อื่นๆ</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">จุดหมาย</label>
                            <input type="text" id="destination" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="สถานที่ที่จะไป" required>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">เวลาออก</label>
                                <input type="time" id="departureTime" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">เวลากลับ (คาดการณ์)</label>
                                <input type="time" id="returnTime" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            ลงทะเบียน
                        </button>
                    </form>
                </div>
            </div>

            <!-- Vehicle List and Map Panel -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Vehicle List -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                        </svg>
                        รายการรถที่ใช้งาน
                        <span id="vehicleCount" class="ml-2 bg-green-100 text-green-800 text-sm px-2 py-1 rounded-full">0 คัน</span>
                    </h2>
                    
                    <div id="vehicleList" class="space-y-3 max-h-64 overflow-y-auto">
                        <div class="text-center text-gray-500 py-8">
                            <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
                            </svg>
                            ยังไม่มีรถลงทะเบียน
                        </div>
                    </div>
                </div>

                <!-- Map Panel -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-red-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        แผนที่ตำแหน่งรถ
                    </h2>
                    
                    <div class="map-container h-80 rounded-lg border-2 border-gray-200 relative">
                        <!-- Roads -->
                        <div class="road road-horizontal"></div>
                        <div class="road road-vertical"></div>
                        <div class="road road-vertical-2"></div>
                        
                        <!-- Map Legend -->
                        <div class="absolute top-4 right-4 bg-white p-3 rounded-lg shadow-md">
                            <h4 class="font-medium text-sm mb-2">สัญลักษณ์</h4>
                            <div class="space-y-1 text-xs">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                    <span>ส่งสินค้า</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                    <span>รับสินค้า</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                                    <span>ติดต่อลูกค้า</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                                    <span>อื่นๆ</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Company Location -->
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                            <div class="bg-red-600 text-white px-3 py-1 rounded-lg text-sm font-medium shadow-lg">
                                🏢 TCM Transportation
                            </div>
                        </div>
                        
                        <div id="mapVehicles"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let vehicles = [];
        let vehicleIdCounter = 1;

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString('th-TH');
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('th-TH');
        }

        // Set current time as default departure time
        function setDefaultTime() {
            const now = new Date();
            const timeString = now.toTimeString().slice(0, 5);
            document.getElementById('departureTime').value = timeString;
        }

        // Get color based on job type
        function getJobColor(jobType) {
            const colors = {
                'ส่งสินค้า': 'bg-green-500',
                'รับสินค้า': 'bg-blue-500',
                'ติดต่อลูกค้า': 'bg-purple-500',
                'ประชุมนอกสถานที่': 'bg-indigo-500',
                'บำรุงรักษา': 'bg-yellow-500',
                'อื่นๆ': 'bg-orange-500'
            };
            return colors[jobType] || 'bg-gray-500';
        }

        // Generate random position for map
        function getRandomPosition() {
            return {
                x: Math.random() * 80 + 10, // 10% to 90%
                y: Math.random() * 80 + 10  // 10% to 90%
            };
        }

        // Add vehicle to list
        function addVehicleToList(vehicle) {
            const vehicleList = document.getElementById('vehicleList');
            
            // Remove empty message if exists
            if (vehicleList.children.length === 1 && vehicleList.children[0].textContent.includes('ยังไม่มีรถลงทะเบียน')) {
                vehicleList.innerHTML = '';
            }

            const vehicleItem = document.createElement('div');
            vehicleItem.className = 'bg-gray-50 p-4 rounded-lg border border-gray-200';
            vehicleItem.innerHTML = `
                <div class="flex justify-between items-start">
                    <div class="flex-1">
                        <div class="flex items-center mb-2">
                            <span class="font-bold text-lg text-gray-800">${vehicle.plateNumber}</span>
                            <span class="ml-2 px-2 py-1 ${getJobColor(vehicle.jobType)} text-white text-xs rounded-full">${vehicle.jobType}</span>
                        </div>
                        <p class="text-sm text-gray-600"><strong>ผู้ขับ:</strong> ${vehicle.driverName}</p>
                        <p class="text-sm text-gray-600"><strong>จุดหมาย:</strong> ${vehicle.destination}</p>
                        <p class="text-sm text-gray-600"><strong>เวลาออก:</strong> ${vehicle.departureTime}</p>
                        ${vehicle.returnTime ? `<p class="text-sm text-gray-600"><strong>เวลากลับ:</strong> ${vehicle.returnTime}</p>` : ''}
                    </div>
                    <button onclick="removeVehicle(${vehicle.id})" class="text-red-500 hover:text-red-700 ml-4">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
            `;
            
            vehicleList.appendChild(vehicleItem);
        }

        // Add vehicle to map
        function addVehicleToMap(vehicle) {
            const mapVehicles = document.getElementById('mapVehicles');
            const position = getRandomPosition();
            
            const marker = document.createElement('div');
            marker.className = 'vehicle-marker';
            marker.style.left = position.x + '%';
            marker.style.top = position.y + '%';
            marker.id = `marker-${vehicle.id}`;
            
            marker.innerHTML = `
                <div class="relative group">
                    <div class="w-4 h-4 ${getJobColor(vehicle.jobType)} rounded-full border-2 border-white shadow-lg"></div>
                    <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                        ${vehicle.plateNumber} - ${vehicle.jobType}
                    </div>
                </div>
            `;
            
            mapVehicles.appendChild(marker);
        }

        // Remove vehicle
        function removeVehicle(vehicleId) {
            vehicles = vehicles.filter(v => v.id !== vehicleId);
            updateVehicleDisplay();
        }

        // Update vehicle display
        function updateVehicleDisplay() {
            // Update count
            document.getElementById('vehicleCount').textContent = `${vehicles.length} คัน`;
            
            // Clear and rebuild list
            const vehicleList = document.getElementById('vehicleList');
            vehicleList.innerHTML = '';
            
            if (vehicles.length === 0) {
                vehicleList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
                        </svg>
                        ยังไม่มีรถลงทะเบียน
                    </div>
                `;
            } else {
                vehicles.forEach(vehicle => addVehicleToList(vehicle));
            }
            
            // Clear and rebuild map
            const mapVehicles = document.getElementById('mapVehicles');
            mapVehicles.innerHTML = '';
            vehicles.forEach(vehicle => addVehicleToMap(vehicle));
        }

        // Handle form submission
        document.getElementById('vehicleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const vehicle = {
                id: vehicleIdCounter++,
                plateNumber: document.getElementById('plateNumber').value,
                driverName: document.getElementById('driverName').value,
                jobType: document.getElementById('jobType').value,
                destination: document.getElementById('destination').value,
                departureTime: document.getElementById('departureTime').value,
                returnTime: document.getElementById('returnTime').value
            };
            
            vehicles.push(vehicle);
            updateVehicleDisplay();
            
            // Reset form
            this.reset();
            setDefaultTime();
            
            // Show success message
            const button = this.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = `
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                ลงทะเบียนสำเร็จ!
            `;
            button.className = 'w-full bg-green-600 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center';
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.className = 'w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center';
            }, 2000);
        });

        // Initialize
        updateDateTime();
        setInterval(updateDateTime, 1000);
        setDefaultTime();
    </script>
</body>
</html>